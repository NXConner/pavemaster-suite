import{c as O,aA as ae,r as a,j as e,i as r,Q as c,aB as U,k as t,n as J,s as H,V as l,W as o,a9 as te,O as le,ay as oe,J as de,az as xe,ap as x,aC as me,a3 as he,a4 as ue,a5 as T,o as X,a as ee,g as se,aa as V,a7 as pe}from"./index-ChsUsUzn.js";import{M as ne}from"./message-square-DmBYsu1V.js";import{V as Q}from"./volume-2-BS2pm8kr.js";import{M as A}from"./mic-BonLplW2.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=O("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=O("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=O("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=O("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);function re({onTranscription:G,onResponse:L,className:Y=""}){const{toast:m}=ae(),[h,k]=a.useState(!1),[S,f]=a.useState(!1),[R,p]=a.useState(!1),[z,E]=a.useState(""),[$,M]=a.useState(0),u=a.useRef(null),B=a.useRef([]),g=a.useRef(null),j=a.useRef(null),y=a.useRef();a.useEffect(()=>()=>{y.current&&cancelAnimationFrame(y.current),g.current&&g.current.close()},[]);const s=()=>{if(!j.current)return;const n=new Uint8Array(j.current.frequencyBinCount);j.current.getByteFrequencyData(n);const d=n.reduce((i,w)=>i+w)/n.length;M(d/255),h&&(y.current=requestAnimationFrame(s))},v=async()=>{try{const n=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:44100,channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});g.current=new AudioContext,j.current=g.current.createAnalyser(),g.current.createMediaStreamSource(n).connect(j.current),j.current.fftSize=256,u.current=new MediaRecorder(n,{mimeType:"audio/webm;codecs=opus"}),B.current=[],u.current.ondataavailable=i=>{i.data.size>0&&B.current.push(i.data)},u.current.onstop=async()=>{const i=new Blob(B.current,{type:"audio/webm"});await N(i),n.getTracks().forEach(w=>{w.stop()})},u.current.start(),k(!0),s(),m({title:"Recording started",description:"Speak now..."})}catch{m({title:"Recording failed",description:"Could not access microphone",variant:"destructive"})}},C=()=>{u.current&&h&&(u.current.stop(),k(!1),M(0),y.current&&cancelAnimationFrame(y.current))},N=async n=>{f(!0);try{const d=await n.arrayBuffer(),i=btoa(String.fromCharCode(...new Uint8Array(d))),{data:w,error:F}=await H.functions.invoke("voice-to-text",{body:{audio:i}});if(F)throw F;const I=w.text;E(I),G?.(I);const{data:D,error:b}=await H.functions.invoke("ai-assistant",{body:{message:I,context:"voice_interface"}});if(b)throw b;const _=D.response;L?.(_);const{data:ie,error:K}=await H.functions.invoke("text-to-speech",{body:{text:_,voice:"alloy"}});if(K)throw K;await W(ie.audioContent),m({title:"Processing complete",description:"AI response generated and played"})}catch{m({title:"Processing failed",description:"Could not process voice command",variant:"destructive"})}finally{f(!1)}},W=async n=>{p(!0);try{const d=atob(n),i=new ArrayBuffer(d.length),w=new Uint8Array(i);for(let b=0;b<d.length;b++)w[b]=d.charCodeAt(b);const F=new Blob([i],{type:"audio/mpeg"}),I=URL.createObjectURL(F),D=new Audio(I);D.onended=()=>{p(!1),URL.revokeObjectURL(I)},await D.play()}catch{p(!1)}},ce=()=>{h?C():v()};return e.jsx(r,{className:`w-full max-w-md mx-auto ${Y}`,children:e.jsxs(c,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5"}),"Voice Assistant"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[S&&e.jsx(U,{className:"h-4 w-4 animate-spin"}),R&&e.jsx(Q,{className:"h-4 w-4 text-primary animate-pulse"})]})]}),h&&e.jsx("div",{className:"w-full bg-secondary rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-100 ease-out",style:{width:`${Math.min($*100,100)}%`}})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[h&&e.jsxs(t,{variant:"destructive",className:"animate-pulse",children:[e.jsx(A,{className:"h-3 w-3 mr-1"}),"Recording"]}),S&&e.jsxs(t,{variant:"secondary",children:[e.jsx(U,{className:"h-3 w-3 mr-1 animate-spin"}),"Processing"]}),R&&e.jsxs(t,{variant:"default",children:[e.jsx(Q,{className:"h-3 w-3 mr-1"}),"Speaking"]})]}),z&&e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"You said:"}),e.jsx("p",{className:"text-sm",children:z})]}),e.jsx(J,{onClick:ce,disabled:S||R,variant:h?"destructive":"default",className:"w-full",size:"lg",children:h?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Stop Recording"]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Start Recording"]})}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Click to start voice conversation with AI assistant"})]})})}function P({className:G="",context:L="general"}){const{toast:Y}=ae(),[m,h]=a.useState([]),[k,S]=a.useState(""),[f,R]=a.useState(!1),[p,z]=a.useState(!1),E=a.useRef(null),$=()=>{E.current?.scrollIntoView({behavior:"smooth"})};a.useEffect(()=>{$()},[m]);const M=(s,v,C="text")=>{const N={id:Date.now().toString(),role:s,content:v,timestamp:new Date,type:C};return h(W=>[...W,N]),N},u=async(s,v="text")=>{if(s.trim()){M("user",s,v),R(!0);try{const{data:C,error:N}=await H.functions.invoke("ai-assistant",{body:{message:s,context:L,conversation:m.slice(-10)}});if(N)throw N;M("assistant",C.response,v)}catch{M("assistant","Sorry, I encountered an error. Please try again.",v),Y({title:"Error",description:"Failed to get AI response",variant:"destructive"})}finally{R(!1)}}},B=s=>{s.preventDefault(),u(k),S("")},g=s=>{u(s,"voice")},j=s=>{},y=()=>{switch(L){case"pavement":return"You are a specialized AI assistant for pavement and asphalt operations. Help with calculations, material specs, and best practices.";case"project":return"You are a project management AI assistant. Help with scheduling, resource allocation, and project coordination.";case"safety":return"You are a safety AI assistant for construction operations. Focus on safety protocols, compliance, and risk management.";default:return"You are a helpful AI assistant for the Pavement Performance Suite application."}};return e.jsxs(r,{className:`flex flex-col h-[600px] ${G}`,children:[e.jsx(l,{className:"flex-shrink-0",children:e.jsxs(o,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5 text-primary"}),"AI Assistant",e.jsx(t,{variant:"secondary",className:"text-xs",children:L})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(J,{variant:p?"default":"outline",size:"sm",onClick:()=>{z(!p)},children:p?e.jsx(Q,{className:"h-4 w-4"}):e.jsx(A,{className:"h-4 w-4"})})})]})}),e.jsxs(c,{className:"flex-1 flex flex-col gap-4 p-4",children:[p&&e.jsx(re,{onTranscription:g,onResponse:j,className:"mb-4"}),e.jsx(le,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-4",children:[m.length===0&&e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Start a conversation with the AI assistant"}),e.jsx("p",{className:"text-sm",children:y()})]}),m.map(s=>e.jsxs("div",{className:`flex gap-3 ${s.role==="user"?"justify-end":"justify-start"}`,children:[s.role==="assistant"&&e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary rounded-full flex items-center justify-center",children:e.jsx(q,{className:"h-4 w-4 text-primary-foreground"})}),e.jsxs("div",{className:`max-w-[80%] rounded-lg px-4 py-2 ${s.role==="user"?"bg-primary text-primary-foreground ml-12":"bg-muted text-foreground mr-12"}`,children:[e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.content}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-xs opacity-70",children:s.timestamp.toLocaleTimeString()}),s.type==="voice"&&e.jsxs(t,{variant:"outline",className:"text-xs h-4",children:[e.jsx(A,{className:"h-2 w-2 mr-1"}),"Voice"]})]})]}),s.role==="user"&&e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-secondary rounded-full flex items-center justify-center",children:e.jsx(oe,{className:"h-4 w-4 text-secondary-foreground"})})]},s.id)),f&&e.jsxs("div",{className:"flex gap-3 justify-start",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary rounded-full flex items-center justify-center",children:e.jsx(q,{className:"h-4 w-4 text-primary-foreground"})}),e.jsx("div",{className:"bg-muted text-foreground rounded-lg px-4 py-2 mr-12",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 animate-spin"}),e.jsx("p",{className:"text-sm",children:"Thinking..."})]})})]}),e.jsx("div",{ref:E})]})}),e.jsxs("form",{onSubmit:B,className:"flex gap-2",children:[e.jsx(de,{value:k,onChange:s=>{S(s.target.value)},placeholder:"Ask me anything about pavement operations...",disabled:f,className:"flex-1"}),e.jsx(J,{type:"submit",disabled:f||!k.trim(),size:"icon",children:f?e.jsx(U,{className:"h-4 w-4 animate-spin"}):e.jsx(fe,{className:"h-4 w-4"})})]})]})]})}function we(){return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(xe,{}),e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"AI Hub"}),e.jsx("p",{className:"text-muted-foreground",children:"Intelligent assistance for pavement operations and project management"})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 mb-8",children:[e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5 text-primary"}),"Chat Assistant"]}),e.jsx(x,{children:"Get instant answers to your questions about pavement operations"})]}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{variant:"default",children:"Active"}),e.jsx(t,{variant:"secondary",children:"GPT-4"})]})})]}),e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-primary"}),"Voice Commands"]}),e.jsx(x,{children:"Hands-free operation with voice-to-text and text-to-speech"})]}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{variant:"default",children:"Enabled"}),e.jsx(t,{variant:"secondary",children:"Whisper"})]})})]}),e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5 text-primary"}),"Smart Calculations"]}),e.jsx(x,{children:"AI-powered material calculations and cost estimations"})]}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{variant:"default",children:"Ready"}),e.jsx(t,{variant:"secondary",children:"ML"})]})})]})]}),e.jsxs(he,{defaultValue:"general",className:"space-y-6",children:[e.jsxs(ue,{className:"grid w-full grid-cols-6",children:[e.jsxs(T,{value:"general",className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"General"]}),e.jsxs(T,{value:"pavement",className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"Pavement"]}),e.jsxs(T,{value:"project",className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Project"]}),e.jsxs(T,{value:"safety",className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Safety"]}),e.jsxs(T,{value:"finance",className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Finance"]}),e.jsxs(T,{value:"voice",className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Voice"]})]}),e.jsx(V,{value:"general",className:"space-y-6",children:e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"General AI Assistant"]}),e.jsx(x,{children:"Get help with general questions about the application, navigation, and basic functionality."})]}),e.jsx(c,{children:e.jsx(P,{context:"general"})})]})}),e.jsx(V,{value:"pavement",className:"space-y-6",children:e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"Pavement Specialist"]}),e.jsx(x,{children:"Expert guidance on asphalt operations, mix designs, quality control, and pavement construction."})]}),e.jsx(c,{children:e.jsx(P,{context:"pavement"})})]})}),e.jsx(V,{value:"project",className:"space-y-6",children:e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5"}),"Project Manager"]}),e.jsx(x,{children:"Assistance with project planning, scheduling, resource allocation, and progress tracking."})]}),e.jsx(c,{children:e.jsx(P,{context:"project"})})]})}),e.jsx(V,{value:"safety",className:"space-y-6",children:e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Safety Advisor"]}),e.jsx(x,{children:"Safety protocols, OSHA compliance, hazard identification, and emergency procedures."})]}),e.jsx(c,{children:e.jsx(P,{context:"safety"})})]})}),e.jsx(V,{value:"finance",className:"space-y-6",children:e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"Financial Advisor"]}),e.jsx(x,{children:"Cost tracking, profitability analysis, pricing strategies, and financial reporting."})]}),e.jsx(c,{children:e.jsx(P,{context:"finance"})})]})}),e.jsx(V,{value:"voice",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Voice Interface"]}),e.jsx(x,{children:"Interact with AI using voice commands and get spoken responses."})]}),e.jsx(c,{children:e.jsx(re,{})})]}),e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-5 w-5"}),"Voice Features"]}),e.jsx(x,{children:"Advanced voice capabilities and settings"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Speech Recognition"}),e.jsx(t,{variant:"default",children:"Whisper-1"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Text-to-Speech"}),e.jsx(t,{variant:"default",children:"OpenAI TTS"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Voice Model"}),e.jsx(t,{variant:"secondary",children:"Alloy"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Language"}),e.jsx(t,{variant:"secondary",children:"English"})]})]})]})]})})]})]})]})}export{we as default};
